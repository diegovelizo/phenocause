% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wrappers.R
\name{sample_causal_sites.ldak}
\alias{sample_causal_sites.ldak}
\title{Sample causal genetic variants (ldak mode)}
\usage{
sample_causal_sites.ldak(
  gds_paths,
  n_causal_sites,
  ldak_ld_weights_paths,
  ldak_chrs = NULL,
  stabilize_sampling_weights = TRUE,
  weights_power = 1,
  missingness_threshold = NULL,
  mac_threshold = NULL,
  n_threads = 1
)
}
\arguments{
\item{gds_paths}{A character vector of paths to the GDS files. When \code{length > 1}, each file is expected to contain data for a single chromosome.}

\item{n_causal_sites}{A single positive integer specifying the total number of causal sites to sample across all GDS files.}

\item{ldak_ld_weights_paths}{A character vector of paths to LDAK weights files. The file must have either two
or three columns.
\itemize{
\item Two-columns files: Raw (no header) *.short output file by \code{ldak --calc-weights}. The columns are \code{rsid} and \code{weight}.
\item Three-columns files: File with a header, containing columns \code{chr} \code{rsid} and \code{weight} (case-insensitive).
See \code{ldak_chrs} for how chromosome information is handled for 2-column files. Cannot be used with \code{sampling_weights_paths}.
}}

\item{ldak_chrs}{A character vector used to assign chromosomes to the files specified in \code{ldak_ld_weights_paths}. This is required only when the LDAK files are in the standard 2-column format (rsid, weight) AND the number of LDAK weight files does not match the number of GDS files. Its length must match \code{length(ldak_ld_weights_paths)}. It is ignored if the LDAK files are in a 3-column format with a 'chr' column header.}

\item{stabilize_sampling_weights}{A logical flag. If \code{TRUE} (default), a small constant (10^-6) is added to all weights to prevent zero-probability sampling.}

\item{weights_power}{A numeric value used to raise the sampling weights to a power. Default is 1. For LDAK weights, consider \code{weights_power = -0.25} to enrich for variants in high-LD regions, or \code{weights_power = 0.25} for low-LD regions.}

\item{missingness_threshold}{A numeric value between 0 and 1. Variants with a missingness rate greater than this threshold will be excluded before sampling. Default is \code{NULL}.}

\item{mac_threshold}{A positive integer. Variants with a minor allele count (MAC) less than this threshold will be excluded before sampling. Default is \code{NULL}.}

\item{n_threads}{A positive integer specifying the number of threads for parallel operations on GDS files. Default is 1.}
}
\value{
A list containing two data frames:
\describe{
\item{\code{causal_annotation}}{A data frame with annotations for each of the \code{n_causal_sites} sampled variants.}
\item{\code{causal_genotypes}}{A data frame with \code{n_causal_sites} rows and \code{(k + N)} columns, where \code{k} is the number of annotation columns and \code{N} is the number of samples. It contains the genotypes and annotations for the causal variants.}
}
}
\description{
Samples a specified number of causal variants from a set of GDS files. This function is a wrapper for the \code{ldak_weights} mode of \code{sample_causal_sites()}, where variants are sampled using weights from LDAK software. It can filter sites by missingness or minor allele count (MAC) before sampling and returns the genotypes and annotations of the selected variants.
}
\details{
This function triggers the \code{ldak_weights} sampling mode. It robustly handles cases where the number of GDS files and weight files do not match, under the condition that one of the inputs is a single, consolidated file. If a matched list of per-chromosome GDS and 2-column LDAK files are provided, the chromosome for each weight file is inferred automatically.
}
\examples{
\dontrun{
# Ensure required packages and package data are available for the examples
if (!requireNamespace("data.table", quietly = TRUE) ||
    !requireNamespace("SeqArray", quietly = TRUE)) {
  stop("Please install data.table and SeqArray to run these examples.")
}

##================================================================
## Example: Weighted sampling using LDAK weights
##================================================================
cat(">>> Running Example: LDAK Weighted Sampling\n")
gds_paths <- system.file(
  paste0("extdata/example.chr", 1:3, ".gds"), package = "phenocause"
)
data(phenocause.ldak_weights)
temp_dir <- tempdir()

# Create standard 2-column LDAK weight files (no header)
temp_ldak_paths <- sapply(names(phenocause.ldak_weights), function(chr_name) {
  file_path <- file.path(temp_dir, paste0(chr_name, ".weights.short"))
  data.table::fwrite(
    phenocause.ldak_weights[[chr_name]],
    file = file_path, sep = " ", col.names = FALSE
  )
  return(file_path)
})

# Since the number of GDS files and weight files match, the chromosome
# for each weight file can be inferred automatically.
ldak_sites <- sample_causal_sites.ldak(
  gds_paths = gds_paths,
  n_causal_sites = 300,
  ldak_ld_weights_paths = temp_ldak_paths,
  n_threads = 2
)
stopifnot(nrow(ldak_sites$causal_genotypes) == 300)
cat("OK: LDAK weighted sampling returned the correct number of sites.\n")
file.remove(temp_ldak_paths)
}
}
\seealso{
\code{\link{sample_causal_sites.uniform}}, \code{\link{sample_causal_sites.custom}}, \code{\link{sample_causal_sites.collider}}
}
